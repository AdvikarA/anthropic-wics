(()=>{var e={};e.id=931,e.ids=[931],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},92095:(e,s,i)=>{"use strict";i.r(s),i.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>h,pages:()=>d,routeModule:()=>u,tree:()=>o});var a=i(50482),r=i(69108),t=i(62563),n=i.n(t),l=i(68300),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);i.d(s,c);let o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,51136)),"C:\\Users\\chens\\AI and Coding\\Hackathons\\anthropic-wics\\src\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(i.bind(i,73669)),"C:\\Users\\chens\\AI and Coding\\Hackathons\\anthropic-wics\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,69361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\chens\\AI and Coding\\Hackathons\\anthropic-wics\\src\\app\\page.tsx"],h="/page",m={require:i,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},60208:(e,s,i)=>{Promise.resolve().then(i.bind(i,38444))},38444:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>c});var a=i(95344),r=i(3729),t=i(86671),n=i(89410);function l({source:e,bias:s,biasQuotes:i,userPoliticalProfile:r,isAffirming:t}){return(0,a.jsxs)("div",{className:"source-item",children:[(0,a.jsxs)("div",{className:"source-header",children:[(0,a.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"source-link",children:[a.jsx("span",{className:"source-name",children:e.source}),a.jsx("span",{className:"link-icon",children:"â†—"})]}),a.jsx("span",{className:`bias-tag small bias-${s}`,children:s.charAt(0).toUpperCase()+s.slice(1)})]}),e.quote&&(0,a.jsxs)("div",{className:"quote-item",children:[(0,a.jsxs)("p",{children:['"',e.quote,'"']}),a.jsx("div",{className:`moderating-statement ${t?"affirming":"challenging"}`,children:a.jsx("p",{children:t?`This perspective generally aligns with your views, though it's worth noting that ${"left"===s?"progressive policies may have economic trade-offs and implementation challenges.":"right"===s?"traditional approaches might not address all modern challenges or social inequities.":"centrist positions sometimes lack decisive action on pressing issues."}`:`This source presents a perspective that may challenge your views. Consider that ${"left"===s?"progressive voices often highlight important social equity concerns and systemic issues.":"right"===s?"conservative perspectives can offer valuable insights on economic growth, tradition, and individual responsibility.":"centrist positions often seek practical compromise between competing values and ideologies."}`})})]}),i&&i.length>0&&(0,a.jsxs)("div",{className:"bias-evidence",children:[a.jsx("h5",{className:"bias-evidence-title",children:"Bias indicators:"}),a.jsx("ul",{className:"bias-quotes-list",children:i.map((e,s)=>(0,a.jsxs)("li",{className:"bias-quote",children:['"',e,'"']},s))})]})]})}function c(){let{user:e,signInWithGoogle:s,signOut:i}=(0,t.useAuth)(),[c,o]=(0,r.useState)([]),[d,h]=(0,r.useState)(!0),[m,u]=(0,r.useState)(null),[g,p]=(0,r.useState)([]),[x,j]=(0,r.useState)({}),[N,v]=(0,r.useState)({}),[f,y]=(0,r.useState)(null),[w,b]=(0,r.useState)([]),[A,q]=(0,r.useState)([]);(0,r.useEffect)(()=>{e&&0===c.length&&(U(),P())},[e]);let C=async e=>{try{if(!e||N[e])return;let s=await fetch(`/api/image-search?query=${encodeURIComponent(e)}`);if(!s.ok)throw Error(`Failed to fetch image: ${s.status}`);let i=await s.json();i.imageUrl&&v(s=>({...s,[e]:i.imageUrl}))}catch(s){console.error(`Error fetching image for "${e}":`,s)}},S=async e=>{try{let s=e.filter(e=>!e.imageUrl&&!N[e.headline]);if(0===s.length)return;console.log(`Fetching images for ${s.length} stories`);let i=s.map((e,s)=>new Promise(i=>{setTimeout(()=>{C(e.headline).then(i)},200*s)}));await Promise.all(i)}catch(e){console.error("Error in batch image fetching:",e)}},k=(0,r.useCallback)(async()=>{try{if(!e)return;let s=e.email;if(!s)return;let i=await fetch(`/api/user-profile?userEmail=${encodeURIComponent(s)}`);if(!i.ok){console.error("Failed to fetch user profile from server");return}let a=await i.json();a.surveyResults&&(y(a.surveyResults),console.log("User political profile loaded from server:",a.surveyResults),(0===w.length||0===A.length)&&P())}catch(e){console.error("Error fetching user profile:",e)}},[e,w.length,A.length]),P=async(s=!1)=>{if(!e?.email){console.log("Cannot fetch perspective news: user email not available");return}try{console.log("Fetching perspective-based news...");let i=new URLSearchParams;i.append("userEmail",e.email),i.append("type","all"),s&&i.append("refresh","true");let a=`/api/news/perspective?${i.toString()}`;console.log(`Fetching from: ${a}`);let r=await fetch(a,{headers:{"Cache-Control":"no-cache"}});if(!r.ok)throw Error(`Failed to fetch perspective news: ${r.status}`);let t=await r.json();if(console.log("Perspective API response:",t),t.error)throw Error(`API Error: ${t.error}`);Array.isArray(t.aligningStories)&&(b(t.aligningStories),console.log(`Loaded ${t.aligningStories.length} aligning stories`)),Array.isArray(t.challengingStories)&&(q(t.challengingStories),console.log(`Loaded ${t.challengingStories.length} challenging stories`));let n=[...t.aligningStories||[],...t.challengingStories||[]];await S(n)}catch(e){console.error("Error fetching perspective news:",e)}},$=(e,s)=>{try{if(!s||!Array.isArray(e)||0===e.length){console.log("Cannot categorize: invalid profile or stories");return}let i=((s["Individual Rights"]?.score||5)+(s["Economic Systems"]?.score||5)+(s["Government Role"]?.score||5)+(s["Social Issues"]?.score||5))/4;console.log("User left-right score:",i);let a=[],r=[];e.forEach(e=>{if(!e)return;let s=Array.isArray(e.sourceBias)?e.sourceBias:[],t=s.length>0?s[0]:null,n=t?.bias||"center",l=5;"left"===n?l=8:"right"===n&&(l=2),3>Math.abs(i-l)?a.push(e):r.push(e)}),0===w.length&&b(a),0===A.length&&q(r),console.log(`Categorized ${a.length} affirming and ${r.length} challenging stories`)}catch(e){console.error("Error in categorizeStories:",e),0===w.length&&b([]),0===A.length&&q([])}},U=async(s=!1,i=!1)=>{if(e){h(!0),u(null);try{let e=new AbortController,a=setTimeout(()=>e.abort(),3e4),r=new URLSearchParams;s&&r.append("refresh","true"),i&&r.append("dynamic","true");let t=`/api/news${r.toString()?`?${r.toString()}`:""}`;console.log(`Fetching news from: ${t}`);let n=await fetch(t,{signal:e.signal,headers:{"Cache-Control":"no-cache"}});if(clearTimeout(a),!n.ok)throw Error(`Failed to fetch news: ${n.status}`);let l=await n.json();if(console.log("API response:",l),l.error)throw Error(`API Error: ${l.error}`);let c=l.newsStories||[];console.log(`Received ${c.length} stories from API`);let d=c.map(e=>({headline:e.headline||"Untitled",summary:e.summary||"",sources:Array.isArray(e.sources)?e.sources:[],publishedAt:e.publishedAt,fullContent:e.fullContent,category:e.category||"general",commonFacts:e.commonFacts,uniqueClaims:Array.isArray(e.uniqueClaims)?e.uniqueClaims:[],sourceBias:Array.isArray(e.sourceBias)?e.sourceBias:[],imageUrl:e.imageUrl||null}));if(o(d),i)await S(d);else{let e={};d.forEach(s=>{s.imageUrl&&(e[s.headline]=s.imageUrl)}),v(e)}f||await k(),f&&$(d,f)}catch(e){console.error("Error fetching news:",e),u(e.message||"Failed to load news")}finally{h(!1)}}},E=e=>{j(s=>({...s,[e]:!s[e]}))};return e?(0,a.jsxs)("div",{className:"container",children:[(0,a.jsxs)("div",{className:"header-section",children:[(0,a.jsxs)("div",{className:"page-controls",children:[a.jsx("button",{className:"btn btn-primary",onClick:()=>U(!0,!1),disabled:d,children:d&&!m?"Loading Stored...":"Load Stored News"}),a.jsx("button",{className:"btn btn-secondary ml-2",onClick:()=>U(!0,!0),disabled:d,children:d&&!m?"Fetching Live...":"Fetch Live News"}),a.jsx("button",{className:"btn btn-outline ml-2",onClick:()=>i(),children:"Sign Out"})]}),d&&(0,a.jsxs)("div",{className:"loading-container",children:[a.jsx("div",{className:"spinner"}),a.jsx("span",{className:"loading-text",children:"Loading news stories..."})]}),m&&(0,a.jsxs)("div",{className:"error-container",children:[a.jsx("p",{className:"error-message",children:m}),a.jsx("button",{className:"btn btn-primary",onClick:()=>U(!0),children:"Try Again"})]})]}),!d&&!m&&c.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("section",{className:"hero-section",children:[(0,a.jsxs)("div",{className:"hero-content",children:[a.jsx("span",{className:"category-tag",children:"Featured"}),a.jsx("h1",{className:"hero-title",children:c[0].headline}),a.jsx("p",{className:"hero-summary",children:c[0].summary}),(0,a.jsxs)("div",{className:"hero-metadata",children:[a.jsx("span",{className:"metadata-item",children:c[0].publishedAt?new Date(c[0].publishedAt).toLocaleDateString():"Recent"}),a.jsx("span",{className:"metadata-item",children:c[0].category||"General"})]})]}),(0,a.jsxs)("div",{className:"hero-image-container",children:[a.jsx("div",{className:"matrix-overlay"}),c[0].imageUrl||N[c[0].headline]?a.jsx(n.default,{src:c[0].imageUrl||N[c[0].headline]||"",alt:c[0].headline,width:600,height:400,className:"featured-image"}):(0,a.jsxs)("div",{className:"image-loading",children:[a.jsx("div",{className:"matrix-overlay"}),a.jsx("div",{className:"spinner small"}),a.jsx("span",{className:"loading-text",children:"Finding relevant image..."})]})]})]}),f&&(0,a.jsxs)("section",{className:"political-profile-section",children:[(0,a.jsxs)("div",{className:"profile-header",children:[a.jsx("h2",{className:"section-title",children:"Your News Perspective"}),(0,a.jsxs)("div",{className:"profile-info",children:[a.jsx("p",{children:"Based on your political survey results, we've personalized your news experience."}),a.jsx("a",{href:"/survey",className:"btn-small",children:"Retake Survey"})]})]}),(0,a.jsxs)("div",{className:"affirming-news",children:[(0,a.jsxs)("div",{className:"section-header",children:[a.jsx("h3",{className:"subsection-title",children:"Articles That Align With Your Views"}),a.jsx("button",{onClick:()=>P(!0),className:"refresh-button",title:"Get fresh articles that align with your views",children:"Get Live Articles"})]}),a.jsx("div",{className:"news-grid",children:w.length>0?w.slice(0,3).map((e,s)=>{let i=`affirming-${s}`;return e.sourceBias?.[0]?.bias,(0,a.jsxs)("article",{className:"news-card affirming",children:[a.jsx("div",{className:"card-media",children:e.imageUrl||N[e.headline]?a.jsx("div",{className:"card-image-container",children:a.jsx("img",{src:e.imageUrl||N[e.headline]||"",alt:e.headline,width:300,height:200,className:"card-image"})}):(0,a.jsxs)("div",{className:"image-loading small",children:[a.jsx("div",{className:"spinner mini"}),a.jsx("span",{className:"loading-text small",children:"Finding image..."})]})}),(0,a.jsxs)("div",{className:"card-content",children:[a.jsx("span",{className:"category-tag small",children:e.category||"News"}),a.jsx("h3",{className:"card-title",children:e.headline}),a.jsx("div",{className:"common-facts",children:a.jsx("p",{children:e.summary})}),(0,a.jsxs)("div",{className:"sources-container",children:[(0,a.jsxs)("div",{className:"sources-dropdown-header",onClick:()=>E(i),children:[a.jsx("h4",{className:"sources-title",children:"Sources & Perspectives"}),a.jsx("span",{className:"dropdown-icon",children:x[i]?"â–²":"â–¼"})]}),x[i]&&a.jsx("div",{className:"sources-dropdown-content",children:e.sources.map((s,i)=>{let r=e.sourceBias?.find(e=>e.source===s.source)?.bias||"unknown",t=e.sourceBias?.find(e=>e.source===s.source)?.biasQuotes;return a.jsx(l,{source:s,bias:r,biasQuotes:t,userPoliticalProfile:f,isAffirming:!0},i)})})]})]})]},i)}):a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:'No articles found that align with your views. Try clicking "Get Live Articles" to find some.'})})})]}),(0,a.jsxs)("div",{className:"challenging-news",children:[(0,a.jsxs)("div",{className:"section-header",children:[a.jsx("h3",{className:"subsection-title",children:"Articles That Challenge Your Views"}),a.jsx("button",{onClick:()=>P(!0),className:"refresh-button",title:"Get fresh articles that challenge your views",children:"Get Live Articles"})]}),a.jsx("div",{className:"news-grid",children:A.length>0?A.slice(0,3).map((e,s)=>{let i=`challenging-${s}`;return e.sourceBias?.[0]?.bias,(0,a.jsxs)("article",{className:"news-card challenging",children:[a.jsx("div",{className:"card-media",children:e.imageUrl||N[e.headline]?a.jsx("div",{className:"card-image-container",children:a.jsx("img",{src:e.imageUrl||N[e.headline]||"",alt:e.headline,width:300,height:200,className:"card-image"})}):(0,a.jsxs)("div",{className:"image-loading small",children:[a.jsx("div",{className:"spinner mini"}),a.jsx("span",{className:"loading-text small",children:"Finding image..."})]})}),(0,a.jsxs)("div",{className:"card-content",children:[a.jsx("span",{className:"category-tag small",children:e.category||"News"}),a.jsx("h3",{className:"card-title",children:e.headline}),a.jsx("div",{className:"common-facts",children:a.jsx("p",{children:e.summary})}),(0,a.jsxs)("div",{className:"sources-container",children:[(0,a.jsxs)("div",{className:"sources-dropdown-header",onClick:()=>E(i),children:[a.jsx("h4",{className:"sources-title",children:"Sources & Perspectives"}),a.jsx("span",{className:"dropdown-icon",children:x[i]?"â–²":"â–¼"})]}),x[i]&&a.jsx("div",{className:"sources-dropdown-content",children:e.sources.map((s,i)=>{let r=e.sourceBias?.find(e=>e.source===s.source)?.bias||"unknown",t=e.sourceBias?.find(e=>e.source===s.source)?.biasQuotes;return a.jsx(l,{source:s,bias:r,biasQuotes:t,userPoliticalProfile:f,isAffirming:!1},i)})})]})]})]},i)}):a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:'No articles found that challenge your views. Try clicking "Get Live Articles" to find some.'})})})]})]}),(0,a.jsxs)("section",{className:"secondary-news",children:[a.jsx("h2",{className:"section-title",children:"Latest Stories"}),a.jsx("div",{className:"news-grid",children:c.filter(e=>e.headline!==c[0].headline).slice(0,5).map((e,s)=>{let i=`story-${s}`;return e.sourceBias?.[0]?.bias,(0,a.jsxs)("article",{className:"news-card",children:[a.jsx("div",{className:"card-media",children:e.imageUrl||N[e.headline]?a.jsx("div",{className:"card-image-container",children:a.jsx("img",{src:e.imageUrl||N[e.headline]||"",alt:e.headline,width:300,height:200,className:"card-image"})}):(0,a.jsxs)("div",{className:"image-loading small",children:[a.jsx("div",{className:"spinner mini"}),a.jsx("span",{className:"loading-text small",children:"Finding image..."})]})}),(0,a.jsxs)("div",{className:"card-content",children:[a.jsx("span",{className:"category-tag small",children:e.category||"News"}),a.jsx("h3",{className:"card-title",children:e.headline}),a.jsx("div",{className:"story-content",children:a.jsx("p",{children:e.summary})}),(0,a.jsxs)("div",{className:"sources-container",children:[(0,a.jsxs)("div",{className:"sources-dropdown-header",onClick:()=>E(i),children:[a.jsx("h4",{className:"sources-title",children:"Sources & Perspectives"}),a.jsx("span",{className:"dropdown-icon",children:x[i]?"â–²":"â–¼"})]}),x[i]&&a.jsx("div",{className:"sources-dropdown-content",children:e.sources.map((s,i)=>{let r=e.sourceBias?.find(e=>e.source===s.source)?.bias||"unknown",t=e.sourceBias?.find(e=>e.source===s.source)?.biasQuotes||[];return(0,a.jsxs)("div",{className:"source-item",children:[(0,a.jsxs)("div",{className:"source-header",children:[a.jsx("h5",{className:"source-title",children:s.title||s.source}),a.jsx("span",{className:`bias-tag ${r}`,children:r})]}),s.quote&&(0,a.jsxs)("blockquote",{className:"source-quote",children:['"',s.quote,'"']}),t&&t.length>0&&(0,a.jsxs)("div",{className:"bias-quotes",children:[a.jsx("h6",{className:"bias-quotes-title",children:"Bias Indicators:"}),a.jsx("ul",{className:"bias-quotes-list",children:t.map((e,s)=>(0,a.jsxs)("li",{className:"bias-quote",children:['"',e,'"']},s))})]})]},i)})})]})]})]},i)})})]})]})]}):(0,a.jsxs)("div",{className:"empty-state",children:[a.jsx("h1",{className:"empty-title",children:"Welcome to AI News"}),a.jsx("p",{className:"empty-description",children:"Please sign in to view the latest news."}),a.jsx("button",{className:"btn btn-primary",onClick:()=>s(),children:"Sign in with Google"})]})}i(26872)},51136:(e,s,i)=>{"use strict";i.r(s),i.d(s,{$$typeof:()=>t,__esModule:()=>r,default:()=>n});let a=(0,i(86843).createProxy)(String.raw`C:\Users\chens\AI and Coding\Hackathons\anthropic-wics\src\app\page.tsx`),{__esModule:r,$$typeof:t}=a,n=a.default},26872:()=>{}};var s=require("../webpack-runtime.js");s.C(e);var i=e=>s(s.s=e),a=s.X(0,[638,651,410,463],()=>i(92095));module.exports=a})();